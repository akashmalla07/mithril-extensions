<html>
<head>
	<title></title>
	<script src="mithril.js"></script>
	<script src="mithril.sugartags.js"></script>
	<script src="mithril.template.js"></script>
	<style>
		.hide { display: none; }
	</style>
</head>
<body>

<div id="content"></div>

<!-- Main template (embedded) -->
<script id="list" type="text/mithrill">
	DIV([
		//	Use an embedded template
		m.template('listHeader'),
		//	Uses a ajax loaded template
		LABEL(m.template(data.inputTmpl(), data)),
		UL( {class: "listy"}, [
			data.links.map(function(link) {
				//	Use a template function
				return m.template(data.listItem, link);
			})
		])
	])
</script>

<!-- Main template (embedded) -->
<script>
	m.template.define('list', function(data){
		with(m.sugarTags) {
			return DIV([
				//	Use an embedded template
				m.template('listHeader'),
				//	Uses a ajax loaded template
				LABEL(m.template(data.inputTmpl(), data)),
				UL( {class: "listy"}, [
					data.links.map(function(link) {
						//	Use a template function
						return m.template(data.listItem, link);
					})
				])
			]);
		}
	});
</script>

<!-- Header template (embedded) -->
<script id="listHeader" type="text/mithrill">
	H1("Mithril templates")
</script>


<script>
	var app = {
		model: {
			links: [
				{ href: "#", title: "Link 1", shown: m.prop(true) },
				{ href: "#", title: "Link 2", shown: m.prop(true) },
				{ href: "#", title: "Link 3", shown: m.prop(true) }
			]
		},
		controller: function() {
			var self = this;
			self.links = app.model.links;
			self.hideLinks = function(){
				for(var i = 0; i < self.links.length; i += 1) {
					self.links[i].shown(!self.links[i].shown());
				}
			};

			//	Inline template for list items
			self.listItem = function(data){
				with(m.sugarTags) {
					return LI({class: data.shown()?"":"hide"},
						A({href: data.href}, data.title)
					)
				};
			};

			//	Setup remote loading for input template
			self.inputTmpl = m.template.load("input.tmpl.js");
		},
		view: function(ctrl) {
			return [
				//m.template('list', ctrl)
				m.template.render('list', ctrl)
			];
		}
	};

	//	initialize
	m.module(document.getElementById("content"), app);
</script>
</body>
</html>
